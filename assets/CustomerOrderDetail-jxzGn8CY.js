import{e as I,P as N,j as t,d as S,r as m,a6 as f,H as P,I as D,ah as k,F as L,a0 as A}from"./index-rdRMhbka.js";import{u as R}from"./orderStore-DrYhPAoN.js";import{U as M,O,E as T}from"./EstimatedTime-BDF1GTtu.js";import{H as U}from"./Header-DGBnppOr.js";import{u as B}from"./useSystemContext-CVQYAq24.js";import{u as H}from"./useCategoryQueries-TloBmK-i.js";import{C as q}from"./CartItemCard-C1vtmwOb.js";import"./useQueries-DYHTCxqj.js";import"./blur-BUf-bq_w.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=I("MessageSquareDiff",[["path",{d:"m5 19-2 2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2",key:"1xuzuj"}],["path",{d:"M9 10h6",key:"9gxzsh"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 17h6",key:"r8uit2"}]]),h=({setShowAddReview:e})=>t.jsxs("footer",{className:"cursor-pointer font-notoTC  bg-orange-500 p-4 text-center text-white flex justify-center items-center",onClick:()=>e(!0),children:[t.jsx("span",{className:"text-xl px-2 pt-1",children:t.jsx(z,{})}),t.jsx("span",{className:"text-xl font-bold mr-2",children:"撰寫評論"})]});h.propTypes={setShowAddReview:N.func.isRequired};const X=()=>{var c;const e=R(s=>s.orderData),r=S(),[p,n]=m.useState(!1),{userInfo:l}=B();if(m.useEffect(()=>{e===null&&r("/history/order")},[e,r]),e===null)return t.jsx(f,{});const g={PENDING:{text:"未接單",bgColor:"bg-stone-600"},PROCESSING:{text:"製作中",bgColor:"bg-blue-500"},COMPLETED:{text:"未取餐",bgColor:"bg-yellow-500"},PICKED_UP:{text:"已取餐",bgColor:"bg-green-500"},CANCELED:{text:"取消",bgColor:"bg-gray-300"}},d=s=>g[s]||{text:"default",bgColor:"bg-gray-200"},C=t.jsx("button",{className:`${d(e==null?void 0:e.status).bgColor} text-sm px-3 py-1 rounded-md text-white font-bold`,children:d(e==null?void 0:e.status).text}),{storeData:o,isLoading:j,isError:b}=P([e.storeId]),a=o?o[0].menuId:null,{menuCategoryList:w}=D(a),{categoryData:v}=H(w,a,l!==void 0&&a!==void 0),y=async()=>{await r(-1)},E=s=>{const x=v.flatMap(i=>i.dishes).find(i=>i.id===s);return x?x.picture:null};return j||o===void 0||b?t.jsx(f,{}):(e==null?void 0:e.status)==="PICKED_UP"&&p&&o?t.jsx(k,{storeName:(c=o[0])==null?void 0:c.name,setShowAddReview:n,storeId:e.storeId}):t.jsxs("div",{className:"flex flex-col h-screen",children:[t.jsx("div",{className:"sticky mt-[54px] z-50 shadow-sm",children:t.jsx(U,{LeftIcon:t.jsx(L,{icon:A}),title:"單號 "+e.id.slice(-5),onLeftClick:y,rightComponents:[C]})}),t.jsxs("div",{className:"flex-1 overflow-auto pb-[48px]",children:[t.jsxs("div",{className:"bg-white text-black flex-1 p-4 overflow-auto",children:[t.jsx(M,{user:e,storeData:o[0],role:l.role}),t.jsx(O,{note:e.note}),e.orderedDishes.map((s,u)=>t.jsx(q,{dishData:s,imageUrl:E(s.dishId),showAdjustBtn:!1},u))]}),(e==null?void 0:e.status)==="PICKED_UP"?t.jsx("div",{className:"fixed bottom-0 left-0 right-0 w-full",children:t.jsx(h,{setShowAddReview:n})}):(e==null?void 0:e.status)!=="CANCELED"&&t.jsx("div",{className:"fixed bottom-0 left-0 right-0 w-full",children:t.jsx(T,{value:e.estimatedPrepTime})})]})]})};export{X as default};
