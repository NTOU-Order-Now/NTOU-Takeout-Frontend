import{b as u,u as l,r as i}from"./index-OyfSnvV0.js";import{u as m}from"./useMutation-CvaJ0Pug.js";const p=async(r,o)=>{const t="https://order-now-image-uploader-d390e8b26c51.herokuapp.com";try{return(await u.post(`${t}/api/images/upload`,o,{headers:{"Content-Type":"multipart/form-data"},signal:r})).data.imageUrl}catch(e){if(u.isCancel(e)){console.debug("POST image request cancelled");return}else console.error("POST image error:",e);throw e}},f=()=>{l();const r=i.useRef(null),{mutateAsync:o,isError:t,error:e,isPending:c}=m({mutationFn:async a=>{r.current&&r.current.abort();const n=new AbortController;r.current=n;const s=new FormData;return s.append("image",a),r.current===n&&(r.current=null),await p(n.signal,s)},onError:a=>{console.log(a),alert("圖片上傳失敗，請勿傳超過10MB大小，格式只能為PNG,JPG,GIF等")}});return{uploadImage:o,isError:t,isPending:c,error:e}};export{f as u};
