import{b as u,u as l,r as i}from"./index-CfmVgRZ1.js";import{u as m}from"./useMutation-surpPT6s.js";const p=async(r,t)=>{try{return console.debug("image",t),(await u.post("undefined/api/images/upload",t,{headers:{"Content-Type":"multipart/form-data"},signal:r})).data.imageUrl}catch(e){if(u.isCancel(e)){console.debug("POST image request cancelled");return}else console.error("POST image error:",e);throw e}},f=()=>{l();const r=i.useRef(null),{mutateAsync:t,isError:n,error:e,isPending:c}=m({mutationFn:async o=>{r.current&&r.current.abort();const a=new AbortController;r.current=a;const s=new FormData;return s.append("image",o),r.current===a&&(r.current=null),await p(a.signal,s)},onError:o=>{console.log(o),alert("圖片上傳失敗")}});return{uploadImage:t,isError:n,isPending:c,error:e}};export{f as u};
