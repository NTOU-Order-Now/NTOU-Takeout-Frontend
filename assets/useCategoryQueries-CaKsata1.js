var L=r=>{throw TypeError(r)};var B=(r,e,s)=>e.has(r)||L("Cannot "+s);var u=(r,e,s)=>(B(r,e,"read from private field"),s?s.call(r):e.get(r)),b=(r,e,s)=>e.has(r)?L("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,s),c=(r,e,s,t)=>(B(r,e,"write to private field"),t?t.call(r,s):e.set(r,s),s),f=(r,e,s)=>(B(r,e,"access private method"),s);import{S as _,n as k,o as j,Q as T,u as G,p as J,q as V,r as w,s as W,t as X,v as Y,w as Z,x as I,y as U,z as $,B as ee,C as se}from"./index-BVyBSOmJ.js";function K(r,e){return r.filter(s=>!e.includes(s))}function te(r,e,s){const t=r.slice(0);return t[e]=s,t}var Q,p,v,E,d,m,q,S,a,D,P,M,H,z,N,re=(N=class extends _{constructor(e,s,t){super();b(this,a);b(this,Q);b(this,p);b(this,v);b(this,E);b(this,d);b(this,m);b(this,q);b(this,S);c(this,Q,e),c(this,E,t),c(this,v,[]),c(this,d,[]),c(this,p,[]),this.setQueries(s)}onSubscribe(){this.listeners.size===1&&u(this,d).forEach(e=>{e.subscribe(s=>{f(this,a,H).call(this,e,s)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,u(this,d).forEach(e=>{e.destroy()})}setQueries(e,s,t){c(this,v,e),c(this,E,s),k.batch(()=>{const n=u(this,d),i=f(this,a,M).call(this,u(this,v));i.forEach(h=>h.observer.setOptions(h.defaultedQueryOptions,t));const o=i.map(h=>h.observer),y=o.map(h=>h.getCurrentResult()),R=o.some((h,C)=>h!==n[C]);n.length===o.length&&!R||(c(this,d,o),c(this,p,y),this.hasListeners()&&(K(n,o).forEach(h=>{h.destroy()}),K(o,n).forEach(h=>{h.subscribe(C=>{f(this,a,H).call(this,h,C)})}),f(this,a,z).call(this)))})}getCurrentResult(){return u(this,p)}getQueries(){return u(this,d).map(e=>e.getCurrentQuery())}getObservers(){return u(this,d)}getOptimisticResult(e,s){const n=f(this,a,M).call(this,e).map(i=>i.observer.getOptimisticResult(i.defaultedQueryOptions));return[n,i=>f(this,a,P).call(this,i??n,s),()=>f(this,a,D).call(this,n,e)]}},Q=new WeakMap,p=new WeakMap,v=new WeakMap,E=new WeakMap,d=new WeakMap,m=new WeakMap,q=new WeakMap,S=new WeakMap,a=new WeakSet,D=function(e,s){const t=f(this,a,M).call(this,s);return t.map((n,i)=>{const o=e[i];return n.defaultedQueryOptions.notifyOnChangeProps?o:n.observer.trackResult(o,y=>{t.forEach(R=>{R.observer.trackProp(y)})})})},P=function(e,s){return s?((!u(this,m)||u(this,p)!==u(this,S)||s!==u(this,q))&&(c(this,q,s),c(this,S,u(this,p)),c(this,m,j(u(this,m),s(e)))),u(this,m)):e},M=function(e){const s=new Map(u(this,d).map(n=>[n.options.queryHash,n])),t=[];return e.forEach(n=>{const i=u(this,Q).defaultQueryOptions(n),o=s.get(i.queryHash);o?t.push({defaultedQueryOptions:i,observer:o}):t.push({defaultedQueryOptions:i,observer:new T(u(this,Q),i)})}),t},H=function(e,s){const t=u(this,d).indexOf(e);t!==-1&&(c(this,p,te(u(this,p),t,s)),f(this,a,z).call(this))},z=function(){var e;if(this.hasListeners()){const s=u(this,m),t=f(this,a,P).call(this,f(this,a,D).call(this,u(this,p),u(this,v)),(e=u(this,E))==null?void 0:e.combine);s!==t&&k.batch(()=>{this.listeners.forEach(n=>{n(u(this,p))})})}},N);function ie({queries:r,...e},s){const t=G(),n=J(),i=V(),o=w.useMemo(()=>r.map(l=>{const g=t.defaultQueryOptions(l);return g._optimisticResults=n?"isRestoring":"optimistic",g}),[r,t,n]);o.forEach(l=>{W(l),X(l,i)}),Y(i);const[y]=w.useState(()=>new re(t,o,e)),[R,h,C]=y.getOptimisticResult(o,e.combine);w.useSyncExternalStore(w.useCallback(l=>n?Z:y.subscribe(k.batchCalls(l)),[y,n]),()=>y.getCurrentResult(),()=>y.getCurrentResult()),w.useEffect(()=>{y.setQueries(o,e,{listeners:!1})},[o,e,y]);const A=R.some((l,g)=>I(o[g],l))?R.flatMap((l,g)=>{const O=o[g];if(O){const F=new T(t,O);if(I(O,l))return U(O,F,i);$(l,n)&&U(O,F,i)}return[]}):[];if(A.length>0)throw Promise.all(A);const x=R.find((l,g)=>{const O=o[g];return O&&ee({result:l,errorResetBoundary:i,throwOnError:O.throwOnError,query:t.getQueryCache().get(O.queryHash)})});if(x!=null&&x.error)throw x.error;return h(C())}const ae=(r,e)=>{let s=!1;const t=ie({queries:r.map(i=>({queryKey:["categoryDishes",e,i.first],queryFn:async()=>{const o=await se.getDishsByCategory(e,i.first);return{categoryName:i.first,dishes:o}},enabled:!!i.second.length&&r!=null,refetchOnWindowFocus:!1,staleTime:1/0}))}),n=t?t.map(i=>i.data).filter(Boolean):[];return s=!0,{categoryData:n,isQueriesSuccess:s}};export{ae as u};
