import{A as b,b as C,f as y,c as D,j as t,i as j,H as v}from"./index-CZV2z4L2.js";import{u as E}from"./orderStore-C6dmvOAT.js";import{U as w,O as N,E as I}from"./EstimatedTime-CN7WdgUb.js";import{H as S}from"./Header-GQ3LpFEU.js";import{F as L,u as P}from"./index-wPuIc0We.js";import{u as k}from"./useSystemContext-CREwBBG8.js";import{u as A}from"./useCategoryQueries-C24iVXcW.js";import{C as O}from"./CartItemCard-BWDKuOJy.js";import"./useQueries-CKIx5xFo.js";import"./useMutation-CzB-mLXn.js";import"./blur-BFT-82LJ.js";const T=async(e,o)=>{try{return(await b.post("/v1/stores/query",e,{signal:o})).data}catch(s){if(C.isCancel(s)){console.debug("Get store data request cancelled");return}else console.error("Get store data error:",s);throw s}},q=e=>{const{data:o,isLoading:s,isError:a,refetch:n}=y({queryKey:["store",e],queryFn:({signal:i})=>T(e,i),enabled:e.length>0,staleTime:9e5});return{storeData:o,isLoading:s,isError:a,refetch:n}},G=()=>{const e=E(r=>r.orderData),o={PENDING:{text:"未接單",bgColor:"bg-red-500"},PROCESSING:{text:"製作中",bgColor:"bg-blue-500"},COMPLETED:{text:"未取餐",bgColor:"bg-yellow-500"},PICKED_UP:{text:"已取餐",bgColor:"bg-green-500"},CANCELED:{text:"取消",bgColor:"bg-gray-300"}},s=D(),a=r=>o[r]||{text:"default",bgColor:"bg-gray-200"},n=t.jsx("button",{className:`${a(e==null?void 0:e.status).bgColor} text-sm px-3 py-1 rounded-md text-white font-bold`,children:a(e==null?void 0:e.status).text});console.debug("orderData",e);const{userInfo:i,merchantData:H}=k();if(e===null){s("/history/order");return}const{storeData:u,isLoaing:f,isError:Q}=q([e.storeId]),l=u?u[0].menuId:null,{menuCategoryList:x}=j(l),{categoryData:d}=A(x,l,i!==void 0&&l!==void 0);console.debug("categoryData",d);const h=()=>{s(-1)},p=r=>{const g=d.flatMap(c=>c.dishes).find(c=>c.id===r);return g?g.picture:null};return f?t.jsx(v,{}):t.jsxs("div",{className:"flex flex-col h-screen",children:[t.jsx("div",{className:"sticky mt-[54px] z-50 shadow-sm",children:t.jsx(S,{LeftIcon:t.jsx(L,{icon:P}),title:"單號 "+e.id.slice(-5),onLeftClick:h,rightComponents:[n]})}),t.jsxs("div",{className:"flex-1 overflow-auto pb-[48px]",children:[t.jsxs("div",{className:"bg-white text-black flex-1 p-4 overflow-auto",children:[t.jsx(w,{user:e}),t.jsx(N,{note:e.note}),e.orderedDishes.map((r,m)=>t.jsx(O,{dishData:r,imageUrl:p(r.dishId),showAdjustBtn:!1},m))]}),t.jsx("div",{className:"fixed bottom-0 left-0 right-0 w-full",children:t.jsx(I,{value:e.estimatedPrepTime})})]})]})};G.propTypes={};export{G as default};
