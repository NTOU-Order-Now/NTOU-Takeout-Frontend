const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/OptionCardSkeleton-CwMHBfku.js","assets/index-BVyBSOmJ.js","assets/index-AsxfWBjN.css","assets/OptionCard-ltJgjLgp.js","assets/index.es-BJrB9fUl.js","assets/index-CuE17EBt.js","assets/blur-DLlne5MJ.js","assets/blur-DOfe2hmq.css","assets/react-CxkCoJ2v.js","assets/CartOption-GveD9Xcb.js"])))=>i.map(i=>d[i]);
import{r as c,_ as p,f as R,a as T,j as i,P as f}from"./index-BVyBSOmJ.js";import{F as P}from"./index.es-BJrB9fUl.js";import{A as k}from"./index-CuE17EBt.js";import{b as q}from"./blur-DLlne5MJ.js";import{c as V}from"./react-CxkCoJ2v.js";const v=V(a=>({dishes:{},allDishAttributes:{},setAllDishAttributes:(e,s)=>a(t=>({allDishAttributes:{...t.allDishAttributes,[e]:s}})),setDishDetail:(e,s)=>a(t=>({dishes:{...t.dishes,[e]:{...t.dishes[e],...s}}})),setQuantity:(e,s)=>a(t=>t.dishes[e]?{dishes:{...t.dishes,[e]:{...t.dishes[e],quantity:s}}}:t),setNote:(e,s)=>a(t=>t.dishes[e]?{dishes:{...t.dishes,[e]:{...t.dishes[e],note:s}}}:t),addChosenAttribute:(e,s)=>a(t=>{const r=t.dishes[e]||{},n=r.chosenAttributes||[];return{dishes:{...t.dishes,[e]:{...r,chosenAttributes:[...n,s]}}}}),removeChosenAttributeOption:(e,s,t)=>a(r=>{if(!r.dishes[e])return r;const n=r.dishes[e].chosenAttributes||[];return{dishes:{...r.dishes,[e]:{...r.dishes[e],chosenAttributes:n.filter(d=>!(d.attributeName===s&&d.chosenOption===t))}}}}),sortChosenAttributes:e=>a(s=>{if(!s.dishes[e])return s;const t=s.dishes[e].chosenAttributes||[];return{dishes:{...s.dishes,[e]:{...s.dishes[e],chosenAttributes:t.sort((r,n)=>r.attributeName!==n.attributeName?r.attributeName.localeCompare(n.attributeName):r.chosenOption!==n.chosenOption?r.chosenOption.localeCompare(n.chosenOption):r.extraCost-n.extraCost)}}}})})),z=c.lazy(()=>p(()=>import("./OptionCardSkeleton-CwMHBfku.js"),__vite__mapDeps([0,1,2]))),L=c.lazy(()=>p(()=>import("./OptionCard-ltJgjLgp.js"),__vite__mapDeps([3,1,2,4,5,6,7,8]))),M=c.lazy(()=>p(()=>import("./CartOption-GveD9Xcb.js"),__vite__mapDeps([9,1,2]))),D=({dishData:a,onClose:e})=>{const{id:s,name:t,price:r,picture:n,description:d,dishAttributes:u}=a,{merchantId:b}=R(),[N,x]=c.useState(!1),[_,w]=c.useState(!1),[g,C]=c.useState(!0),A=v(o=>o.setDishDetail),y=v(o=>o.setAllDishAttributes),O=T.get("authToken"),h=c.useRef([]);c.useEffect(()=>(y(s,u),A(s,{storeId:b,dishId:s,dishName:t,price:r,quantity:1,note:"",chosenAttributes:[]}),x(!0),document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}),[A,s,b,u,y,t,r]);const j=()=>{w(!0),setTimeout(()=>{x(!1),document.body.style.overflow="",e&&e()},500)},E=o=>{const l=u.findIndex(m=>m.name===o);l!==-1&&h.current[l]&&h.current[l].scrollIntoView({behavior:"smooth",block:"start"})},S=o=>{const l=o+1;h.current[l]&&h.current[l].scrollIntoView({behavior:"smooth",block:"start"})};return i.jsx("div",{className:"font-notoTC fixed z-10 top-0 left-0 right-0",children:i.jsxs("div",{className:`bg-white shadow-md overflow-hidden h-dvh flex flex-col  transition-transform duration-500 ${_?"translate-y-full none":"translate-y-0"}
                                                                                                                            ${N?"translate-y-0":"translate-y-full none"}`,children:[i.jsxs("div",{className:"flex-1 overflow-y-auto",children:[i.jsxs("div",{className:"relative h-48 overflow-hidden",children:[i.jsx(q.LazyLoadImage,{className:"w-full h-full object-cover",src:n,alt:t,effect:"blur",wrapperClassName:"absolute inset-0"}),i.jsx("button",{onClick:j,className:"absolute top-4 right-4 bg-white rounded-full w-8 h-8 flex items-center justify-center shadow-md",children:i.jsx(P,{icon:k,className:"text-sm"})})]}),i.jsxs("div",{className:"p-4",children:[i.jsx("h2",{className:"text-xl font-bold",children:t}),i.jsxs("p",{className:"text-lg text-gray-700",children:["$",r]}),i.jsx("p",{className:"text-sm text-gray-500",children:d}),u.map((o,l)=>i.jsx("div",{ref:m=>h.current[l]=m,children:i.jsx(c.Suspense,{fallback:i.jsx(z,{}),children:i.jsx(L,{title:o.name,description:o.description,options:o.attributeOptions,type:o.type,dishId:s,isRequired:o.isRequired,isShowError:g,setIsShowError:C,onSelectNext:()=>S(l)})})},l))]}),i.jsx("div",{className:"py-5"})]}),O&&i.jsx(M,{dishId:s,dishAttributes:u,onRequiredMissing:E,onClose:j})]})})};D.propTypes={dishData:f.object.isRequired,onClose:f.func,dishId:f.string};const X=Object.freeze(Object.defineProperty({__proto__:null,default:D},Symbol.toStringTag,{value:"Module"}));export{X as M,v as u};
