import{b as c,u as l,r as i,c as m}from"./index-Bu6klRY2.js";const p=async(r,o)=>{const t="https://order-now-image-uploader-d390e8b26c51.herokuapp.com";try{return console.debug("image",o),(await c.post(`${t}/api/images/upload`,o,{headers:{"Content-Type":"multipart/form-data"},signal:r})).data.imageUrl}catch(e){if(c.isCancel(e)){console.debug("POST image request cancelled");return}else console.error("POST image error:",e);throw e}},g=()=>{l();const r=i.useRef(null),{mutateAsync:o,isError:t,error:e,isPending:u}=m({mutationFn:async a=>{r.current&&r.current.abort();const n=new AbortController;r.current=n;const s=new FormData;return s.append("image",a),r.current===n&&(r.current=null),await p(n.signal,s)},onError:a=>{console.log(a),alert("圖片上傳失敗")}});return{uploadImage:o,isError:t,isPending:u,error:e}};export{g as u};
