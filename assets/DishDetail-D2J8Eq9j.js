const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/OptionCardSkeleton-D6d1eccX.js","assets/index-CfmVgRZ1.js","assets/index-IvDaJOdz.css","assets/CartRemark-CFuOht7l.js","assets/OptionCard-KS1sfp4D.js","assets/index-9jCZmXH9.js","assets/blur-BAvl7f-d.js","assets/blur-DOfe2hmq.css","assets/CartOption-BqaPkUk1.js"])))=>i.map(i=>d[i]);
import{e as V,r as n,_ as f,h as q,d as z,j as i,P as x}from"./index-CfmVgRZ1.js";import{F as I,H as L}from"./index-9jCZmXH9.js";import{b as M}from"./blur-BAvl7f-d.js";const y=V(c=>({dishes:{},allDishAttributes:{},setAllDishAttributes:(e,t)=>c(s=>({allDishAttributes:{...s.allDishAttributes,[e]:t}})),setDishDetail:(e,t)=>c(s=>({dishes:{...s.dishes,[e]:{...s.dishes[e],...t}}})),setQuantity:(e,t)=>c(s=>s.dishes[e]?{dishes:{...s.dishes,[e]:{...s.dishes[e],quantity:t}}}:s),setNote:(e,t)=>c(s=>s.dishes[e]?{dishes:{...s.dishes,[e]:{...s.dishes[e],note:t}}}:s),addChosenAttribute:(e,t)=>c(s=>{const o=s.dishes[e]||{},l=o.chosenAttributes||[];return{dishes:{...s.dishes,[e]:{...o,chosenAttributes:[...l,t]}}}}),removeChosenAttributeOption:(e,t,s)=>c(o=>{if(!o.dishes[e])return o;const l=o.dishes[e].chosenAttributes||[];return{dishes:{...o.dishes,[e]:{...o.dishes[e],chosenAttributes:l.filter(d=>!(d.attributeName===t&&d.chosenOption===s))}}}}),sortChosenAttributes:e=>c(t=>{if(!t.dishes[e])return t;const s=t.dishes[e].chosenAttributes||[];return{dishes:{...t.dishes,[e]:{...t.dishes[e],chosenAttributes:s.sort((o,l)=>o.attributeName!==l.attributeName?o.attributeName.localeCompare(l.attributeName):o.chosenOption!==l.chosenOption?o.chosenOption.localeCompare(l.chosenOption):o.extraCost-l.extraCost)}}}})})),$=n.lazy(()=>f(()=>import("./OptionCardSkeleton-D6d1eccX.js"),__vite__mapDeps([0,1,2]))),F=n.lazy(()=>f(()=>import("./CartRemark-CFuOht7l.js"),__vite__mapDeps([3,1,2]))),U=n.lazy(()=>f(()=>import("./OptionCard-KS1sfp4D.js"),__vite__mapDeps([4,1,2,5,6,7]))),H=n.lazy(()=>f(()=>import("./CartOption-BqaPkUk1.js"),__vite__mapDeps([8,1,2]))),N=({dishData:c,onClose:e})=>{const{id:t,name:s,price:o,picture:l,description:d,dishAttributes:u}=c,{merchantId:A}=q(),[C,v]=n.useState(!1),[g,w]=n.useState(!1),[E,O]=n.useState(!0),m=y(r=>r.setDishDetail),_=y(r=>r.setAllDishAttributes),j=z(r=>r.user),h=n.useRef([]),[R,S]=n.useState(""),p=y(r=>r.dishes);n.useEffect(()=>(_(t,u),m(t,{storeId:A,dishId:t,dishName:s,price:o,quantity:1,note:"",chosenAttributes:[]}),v(!0),document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}),[m,t,A,u,_,s,o]);const k=n.useCallback(r=>{S(r),p[t]&&m(t,{...p[t],note:r})},[t,p,m]),D=()=>{w(!0),setTimeout(()=>{v(!1),document.body.style.overflow="",e&&e()},500)},T=r=>{const a=u.findIndex(b=>b.name===r);a!==-1&&h.current[a]&&h.current[a].scrollIntoView({behavior:"smooth",block:"start"})},P=r=>{const a=r+1;h.current[a]&&h.current[a].scrollIntoView({behavior:"smooth",block:"start"})};return i.jsx("div",{className:"font-notoTC fixed z-10 top-0 left-0 right-0",children:i.jsxs("div",{className:`bg-white shadow-md overflow-hidden h-dvh flex flex-col  transition-transform duration-500 ${g?"translate-y-full none":"translate-y-0"}
                                                                                                                            ${C?"translate-y-0":"translate-y-full none"}`,children:[i.jsxs("div",{className:"flex-1 overflow-y-auto",children:[i.jsxs("div",{className:"relative h-48 overflow-hidden",children:[i.jsx(M.LazyLoadImage,{className:"w-full h-full object-cover",src:l,alt:s,effect:"blur",wrapperClassName:"absolute inset-0"}),i.jsx("button",{onClick:D,className:"absolute top-4 right-4 bg-white rounded-full w-8 h-8 flex items-center justify-center shadow-md",children:i.jsx(I,{icon:L,className:"text-sm"})})]}),i.jsxs("div",{className:"p-4",children:[i.jsx("h2",{className:"text-xl font-bold",children:s}),i.jsxs("p",{className:"text-lg text-gray-700",children:["$",o]}),i.jsx("p",{className:"text-sm text-gray-500",children:d}),u.map((r,a)=>i.jsx("div",{ref:b=>h.current[a]=b,children:i.jsx(n.Suspense,{fallback:i.jsx($,{}),children:i.jsx(U,{title:r.name,description:r.description,options:r.attributeOptions,type:r.type,dishId:t,isRequired:r.isRequired,isShowError:E,setIsShowError:O,onSelectNext:()=>P(a)})})},a)),i.jsx("div",{className:"pb-12",children:i.jsx(F,{onRemarkChange:k,value:R})})]}),i.jsx("div",{className:"py-5"})]}),j!==void 0&&j.role==="CUSTOMER"&&i.jsx(H,{dishId:t,dishAttributes:u,onRequiredMissing:T,onClose:D})]})})};N.propTypes={dishData:x.object.isRequired,onClose:x.func,dishId:x.string};const G=Object.freeze(Object.defineProperty({__proto__:null,default:N},Symbol.toStringTag,{value:"Module"}));export{G as D,y as u};
